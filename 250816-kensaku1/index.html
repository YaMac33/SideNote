<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«ï¼šè¨˜äº‹å†…å®¹ã‚’ç«¯çš„ã‹ã¤é­…åŠ›çš„ã«è¡¨ç¾ -->
  <title>25.8.16 é™çš„ã‚µã‚¤ãƒˆå‘ã‘ï¼šLunr.js ã¨ Algolia ã§ä½œã‚‹æ¤œç´¢å®Ÿè£…ã‚¬ã‚¤ãƒ‰ï¼ˆJekyllä¸è¦ï¼‰</title>
  <!-- ã‚µã‚¤ãƒˆå…¨ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆæŒ‡å®šã©ãŠã‚Š1å›ã ã‘èª­ã¿è¾¼ã¿ï¼‰ -->
  <link rel="stylesheet" href="/ai-comparison-test-site/style.css" />
  <!-- æœ€ä½é™ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³CSSï¼ˆ20è¡Œä»¥å†…ï¼‰: ãƒ˜ãƒƒãƒ€ãƒ¼é‡ãªã‚Šå›é¿ã€ç”»åƒãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ã€ãƒ•ã‚§ãƒ¼ãƒ‰/ãƒœã‚¿ãƒ³ -->
  <style>
    /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼ã«éš ã‚Œãªã„ã‚ˆã†ã«ä½™ç™½ã‚’ç¢ºä¿ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼æŒ¿å…¥å¾Œã«JSã§èª¿æ•´ï¼‰ */
    .content { padding: 1.5rem; padding-top: var(--header-height,72px); max-width:900px; margin:0 auto; }
    figure img { max-width:100%; height:auto; display:block; }
    .fade-in { opacity:0; transform: translateY(10px); transition: opacity .6s ease, transform .6s ease; }
    .fade-in.visible { opacity:1; transform: translateY(0); }
    #to-top { position:fixed; right:1rem; bottom:1.5rem; display:inline-block; padding:.6rem .8rem; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,.15); background:#fff; cursor:pointer; opacity:0; pointer-events:none; transition:opacity .3s ease; }
    #to-top.show { opacity:1; pointer-events:auto; }
  </style>
</head>
<body>
  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å‹•çš„ã«èª­ã¿è¾¼ã‚€ãŸã‚ã®ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆ -->
  <div id="header-mount" aria-hidden="true"></div>
  <main class="content" id="main-content">
    <!-- ä¸»è¦‹å‡ºã—ï¼ˆçµµæ–‡å­—ã‚’æ§ãˆã‚ã«ï¼‰ -->
    <h1>é™çš„ã‚µã‚¤ãƒˆã§å°å…¥ã™ã‚‹ã‚µã‚¤ãƒˆå†…æ¤œç´¢ï¼šLunr.jsï¼ˆè‡ªåŠ›ï¼‰ã¨Algoliaï¼ˆå¤–éƒ¨ï¼‰ã®2ãƒ‘ã‚¿ãƒ¼ãƒ³è§£èª¬ ğŸ”</h1>
```
<!-- ç›®æ¬¡ã¯JSã§è‡ªå‹•ç”Ÿæˆï¼ˆh2/h3ã‚’æŠ½å‡ºï¼‰ -->
<nav id="table-of-contents" aria-label="ç›®æ¬¡"></nav>
<!-- è¨˜äº‹æœ¬æ–‡ -->
<article id="article-body">
  <!-- æ–¹æ³•Aï¼ˆLunr.jsï¼‰ -->
  <section class="fade-in fade-in-target">
    <h2>æ–¹æ³•Aï¼šLunr.js ã‚’ä½¿ã†ï¼ˆè‡ªåŠ›ã§å®Œçµã•ã›ã‚‹æ–¹æ³•ï¼‰ ğŸ§°</h2>
    <p>å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã«é ¼ã‚‰ãšã€ç„¡æ–™ã§ã‚µã‚¤ãƒˆå†…æ¤œç´¢ã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ã§ã™ã€‚ã‚µã‚¤ãƒˆã®å…¨ãƒšãƒ¼ã‚¸ã®æƒ…å ±ã‚’ã¾ã¨ã‚ãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ‰‹å‹•ï¼ˆã¾ãŸã¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ï¼‰ä½œæˆã—ã€ãã‚Œã‚’ä½¿ã£ã¦æ¤œç´¢ã—ã¾ã™ã€‚</p>
    <h3>ã‚¹ãƒ†ãƒƒãƒ—1ï¼šæ¤œç´¢ãƒ‡ãƒ¼ã‚¿ <code>search-index.json</code> ã‚’ä½œæˆã™ã‚‹</h3>
    <p>ã¾ãšã€ã‚µã‚¤ãƒˆå†…ã®æ¤œç´¢å¯¾è±¡ã«ã—ãŸã„ãƒšãƒ¼ã‚¸ã®æƒ…å ±ã‚’ã¾ã¨ã‚ãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚ä½œæ¥­ã¯æ‰‹å‹•ã§ã‚‚ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã‚‚æ§‹ã„ã¾ã›ã‚“ãŒã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ¤œç´¢ã®æ ¸ã«ãªã‚Šã¾ã™ã€‚</p>
    <figure>
      <!-- ç”»åƒã¯æœ¬æ–‡ã«ç„¡ã„ã®ã§ä¾‹ç¤ºã¯çœç•¥ã€‚altã¯å¿…é ˆã€‚ -->
      <figcaption>search-index.json ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆä¾‹ï¼‰</figcaption>
    </figure>
    <pre><code aria-label="search-index.jsonã®ä¾‹">[
```
{
"id": 0,
"url": "/about.html",
"title": "ã“ã®ã‚µã‚¤ãƒˆã«ã¤ã„ã¦",
"content": "ã“ã®ã‚µã‚¤ãƒˆã®é‹å–¶æ–¹é‡ã‚„ç›®çš„ã«ã¤ã„ã¦èª¬æ˜ã—ã¦ã„ã¾ã™ã€‚..."
},
{
"id": 1,
"url": "/products/item01.html",
"title": "è£½å“Aã®ç´¹ä»‹",
"content": "ä¸»åŠ›è£½å“ã§ã‚ã‚‹è£½å“Aã®æ©Ÿèƒ½ã‚„ç‰¹å¾´ã‚’è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚..."
}
]</code></pre>

```
    <p><strong>ãƒã‚¤ãƒ³ãƒˆï¼š</strong> <em>id</em>ã¯0ã‹ã‚‰é–‹å§‹ã™ã‚‹é€£ç•ªã€<em>url</em>ã¯ãƒšãƒ¼ã‚¸ãƒ‘ã‚¹ã€<em>title</em>ã¨<em>content</em>ã¯æ¤œç´¢ã«ãƒ’ãƒƒãƒˆã•ã›ãŸã„æƒ…å ±ã‚’è¦ç´„ã—ã¦å…¥ã‚Œã¾ã™ã€‚</p>

    <h3>ã‚¹ãƒ†ãƒƒãƒ—2ï¼šHTMLã«æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã¨çµæœã‚¨ãƒªã‚¢ã‚’è¨­ç½®ã™ã‚‹</h3>
    <p>æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã®æœ€ä½é™ã®ä¾‹ï¼š</p>
    <div>
      <label for="search-input">ã‚µã‚¤ãƒˆå†…ã‚’æ¤œç´¢ï¼ˆ2æ–‡å­—ä»¥ä¸Šï¼‰ğŸ”</label>
      <input id="search-input" type="text" placeholder="ã‚µã‚¤ãƒˆå†…ã‚’æ¤œç´¢..." aria-label="ã‚µã‚¤ãƒˆå†…æ¤œç´¢" />
      <ul id="results-container" aria-live="polite"></ul>
    </div>

    <h3>ã‚¹ãƒ†ãƒƒãƒ—3ï¼šJavaScriptã‚’è¨˜è¿°ã™ã‚‹ï¼ˆLunr.jsã‚’ä½¿ç”¨ï¼‰</h3>
    <p>ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ ã—ã¾ã™ã€‚ã¾ãšã¯ Lunr.js æœ¬ä½“ã‚’èª­ã¿è¾¼ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆä¾‹ï¼šCDNï¼‰ã€‚</p>
    <p>å‚è€ƒ CDNï¼ˆã‚¯ãƒªãƒƒã‚¯ã—ã¦åˆ¥ã‚¿ãƒ–ã§é–‹ãï¼‰ï¼š<br />
      <a href="https://unpkg.com/lunr/lunr.min.js">https://unpkg.com/lunr/lunr.min.js</a>
    </p>

    <blockquote>
      <p>ä»¥ä¸‹ã¯è¨˜äº‹ä¸­ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã§ã™ï¼ˆæŠœç²‹ï¼‰ã€‚å®Ÿéš›ã¯ <code>&lt;script src="...">&lt;/script></code> ã‚’ãƒšãƒ¼ã‚¸ã«å«ã‚ã¦ãã ã•ã„ã€‚</p>
    </blockquote>

    <pre><code aria-label="lunrã‚µãƒ³ãƒ—ãƒ«"> &lt;script src="https://unpkg.com/lunr/lunr.min.js">&lt;/script>
```

\<script>
(async function() {
const searchInput = document.getElementById('search-input');
const resultsContainer = document.getElementById('results-container');
const response = await fetch('/search-index.json');
const documents = await response.json();
const idx = lunr(function () {
this.ref('id');
this.field('title');
this.field('content');
documents.forEach(function (doc) { this.add(doc); }, this);
});
searchInput.addEventListener('input', function (event) {
const query = event.target.value;
resultsContainer.innerHTML = '';
if (query.length < 2) return;
const results = idx.search(query);
if (results.length > 0) {
results.forEach(function (result) {
const item = documents.find(doc => doc.id == result.ref);
const li = document.createElement('li');
li.innerHTML = '\<a href="' + item.url + '">' + item.title + '\</a>';
resultsContainer.appendChild(li);
});
} else {
const noResult = document.createElement('li');
noResult.textContent = 'è©²å½“ã™ã‚‹ãƒšãƒ¼ã‚¸ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚';
resultsContainer.appendChild(noResult);
}
});
})();
\</script></code></pre>

```
    <p>ã“ã®æ–¹æ³•ã¯ãƒšãƒ¼ã‚¸æ•°ãŒæ•°åã€œç™¾ãƒšãƒ¼ã‚¸ç¨‹åº¦ã§ã‚ã‚Œã°ååˆ†ã«å®Ÿç”¨çš„ã§ã™ã€‚</p>
  </section>

  <!-- æ–¹æ³•Bï¼ˆç°¡æ½”ã«ï¼‰ -->
  <section class="fade-in fade-in-target">
    <h2>æ–¹æ³•Bï¼šAlgolia ã‚’ä½¿ã†ï¼ˆé«˜æ©Ÿèƒ½ãªå¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ï¼‰ â˜ï¸</h2>
    <p>é«˜æ€§èƒ½ãªå¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚ã‚µãƒ¼ãƒãƒ¼å´ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã—ãŸã‚Šã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å‘ã‘APIã‚­ãƒ¼ã®ç®¡ç†ã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚„ãƒ•ã‚¡ã‚»ãƒƒãƒˆæ¤œç´¢ãªã©é«˜åº¦ãªæ©Ÿèƒ½ãŒä½¿ãˆã¾ã™ã€‚è¦æ¨¡ãŒå¤§ãã„ã‚µã‚¤ãƒˆã‚„æ¤œç´¢ä½“é¨“ã‚’é‡è¦–ã™ã‚‹å ´åˆã«æœ‰åˆ©ã§ã™ã€‚</p>

    <h3>Algolia ã®ãƒ¡ãƒªãƒƒãƒˆ</h3>
    <ul>
      <li>é«˜é€Ÿã§ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªæ¤œç´¢</li>
      <li>ãƒ©ãƒ³ã‚­ãƒ³ã‚°/ãƒ•ã‚¡ã‚»ãƒƒãƒˆ/ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‰ãªã©ã®é«˜åº¦æ©Ÿèƒ½</li>
      <li>ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é¢ã®åˆ©ä¾¿æ€§</li>
    </ul>

    <h3>Algolia ã®æ³¨æ„ç‚¹</h3>
    <ul>
      <li>åˆ©ç”¨æ–™é‡‘ãŒç™ºç”Ÿã™ã‚‹ï¼ˆç„¡æ–™æ ã¯ã‚ã‚‹ãŒåˆ¶é™ã‚ã‚Šï¼‰</li>
      <li>å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã«ä¾å­˜ã™ã‚‹è¨­è¨ˆã«ãªã‚‹</li>
    </ul>
  </section>

  <!-- ã¾ã¨ã‚ -->
  <section class="fade-in fade-in-target">
    <h2>ã¾ã¨ã‚ âœ…</h2>
    <p>å°ã€œä¸­è¦æ¨¡ã®é™çš„ã‚µã‚¤ãƒˆã§ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆè‡ªå‰ã§å®Œçµã•ã›ãŸã„ãªã‚‰ <strong>Lunr.js</strong> ãŒç¾å®Ÿçš„ã§ã™ã€‚ä¸€æ–¹ã€æ¤œç´¢ä½“é¨“ãƒ»æ€§èƒ½ãƒ»é‹ç”¨æ€§ã‚’é‡è¦–ã™ã‚‹å ´åˆã¯ <strong>Algolia</strong> ã‚’æ¤œè¨ã—ã¾ã—ã‚‡ã†ã€‚</p>
    <blockquote>
      <p>å‚è€ƒï¼šè¨˜äº‹å†…ã® Lunr.js CDN ã®URLã¯ <a href="https://unpkg.com/lunr/lunr.min.js">https://unpkg.com/lunr/lunr.min.js</a> ã§ã™ã€‚</p>
    </blockquote>
  </section>
</article>
```

  </main>
  <!-- ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹ãƒœã‚¿ãƒ³ï¼ˆã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã®ãŸã‚aria-labelã‚’ä»˜ä¸ï¼‰ -->
<button id="to-top" aria-label="ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹">â†‘ ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹</button>
  <!-- JavaScriptï¼šãƒ˜ãƒƒãƒ€ãƒ¼èª­ã¿è¾¼ã¿ã€ç›®æ¬¡ç”Ÿæˆã€IntersectionObserverã€ãƒˆãƒƒãƒ—ãƒœã‚¿ãƒ³ç­‰ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆå¤šæ•°ï¼‰ -->
  <script>
    // ============================
    // ãƒ˜ãƒƒãƒ€ãƒ¼ã®å‹•çš„èª­ã¿è¾¼ã¿
    // - fetch + DOMParser ã‚’ä½¿ã„ã€header.html ã® <body> è¦ç´ å†…ï¼ˆã¾ãŸã¯å…¨ä½“ï¼‰ã®ä¸­èº«ã ã‘ã‚’æŒ¿å…¥ã™ã‚‹
    // - header.html ã¯åŒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’æƒ³å®š
    // - èª­ã¿è¾¼ã¿å¾Œã«å®Ÿéš›ã®ãƒ˜ãƒƒãƒ€ãƒ¼é«˜ã•ã‚’ --header-height CSSå¤‰æ•°ã«è¨­å®šã—ã¦é‡ãªã‚Šã‚’é˜²æ­¢
    // ============================
    (async function loadHeader() {
      try {
        const mount = document.getElementById('header-mount');
        const res = await fetch('/ai-comparison-test-site/header.html', {cache: 'no-cache'});
        if (!res.ok) throw new Error('ãƒ˜ãƒƒãƒ€ãƒ¼å–å¾—å¤±æ•—');
        const text = await res.text();
        const parser = new DOMParser();
        const doc = parser.parseFromString(text, 'text/html');

        // å–å¾—ã—ãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã® <body> ã¾ãŸã¯ <div class="site-header"> ç­‰ã‚’æ¢ã—ã¦æŒ¿å…¥
        // å„ªå…ˆçš„ã« body ã®ä¸­èº«ã‚’ä½¿ç”¨
        let contentNode = doc.body;
        // If header is wrapped in specific selector, try to pick it (graceful fallback)
        const specific = doc.querySelector('.site-header') || doc.querySelector('.header-container');
        if (specific) contentNode = specific;

        // Insert the children into mount
        while (mount.firstChild) mount.removeChild(mount.firstChild);
        Array.from(contentNode.childNodes).forEach(node => mount.appendChild(node.cloneNode(true)));

        // After insertion, compute header height and set CSS variable to avoid overlap
        requestAnimationFrame(() => {
          const headerEl = mount.firstElementChild || mount;
          const rect = headerEl.getBoundingClientRect();
          const height = Math.ceil(rect.height) + 8; // å°‘ã—ä½™è£•ã‚’å…¥ã‚Œã‚‹
          document.documentElement.style.setProperty('--header-height', height + 'px');
          mount.setAttribute('aria-hidden', 'false');
        });
      } catch (e) {
        console.error('ãƒ˜ãƒƒãƒ€ãƒ¼èª­ã¿è¾¼ã¿ã§ã‚¨ãƒ©ãƒ¼:', e);
      }
    })();

    // ============================
    // ç›®æ¬¡ï¼ˆTOCï¼‰ã®è‡ªå‹•ç”Ÿæˆ
    // - ãƒšãƒ¼ã‚¸å†…ã® h2/h3 ã‚’æŠ½å‡ºã—ã€h1 ã®ç›´å¾Œã«ç”Ÿæˆ
    // - å„è¦‹å‡ºã—ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯IDã‚’ä»˜ä¸ï¼ˆã‚¹ãƒ©ãƒƒã‚°åŒ– + ç«¶åˆå›é¿ï¼‰
    // - ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ï¼šaria-label ã‚’ä»˜ä¸
    // ============================
    (function buildTOC() {
      // helper: ã‚¹ãƒ©ãƒƒã‚°åŒ–
      function slugify(text) {
        return text.toString().toLowerCase()
          .trim()
          .replace(/[^\w\u3040-\u30ff\u4e00-\u9fff\- ]+/g, '') // æ—¥æœ¬èªã¨è‹±æ•°å­—ã€ã‚¹ãƒšãƒ¼ã‚¹ã®ã¿æ®‹ã™
          .replace(/\s+/g, '-')
          .replace(/\-+/g, '-');
      }

      const content = document.getElementById('article-body');
      if (!content) return;

      const headings = content.querySelectorAll('h2, h3');
      if (headings.length === 0) return;

      const toc = document.getElementById('table-of-contents');
      const ul = document.createElement('ul');
      ul.className = 'toc-list';
      ul.setAttribute('aria-label', 'ç›®æ¬¡ãƒªã‚¹ãƒˆ');

      const used = new Map(); // id é‡è¤‡å›é¿

      headings.forEach(h => {
        // create unique id if missing
        if (!h.id) {
          let base = slugify(h.textContent || h.innerText || 'heading');
          let id = base;
          let i = 1;
          while (used.has(id) || document.getElementById(id)) {
            id = base + '-' + i++;
          }
          used.set(id, true);
          h.id = id;
        }
        // list item
        const li = document.createElement('li');
        li.className = 'toc-item toc-' + h.tagName.toLowerCase();
        const a = document.createElement('a');
        a.href = '#' + h.id;
        a.textContent = (h.tagName.toLowerCase() === 'h2' ? 'â–  ' : 'â€“ ') + h.textContent;
        a.setAttribute('aria-label', 'ç›®æ¬¡ï¼š' + h.textContent);
        li.appendChild(a);
        ul.appendChild(li);
      });

      // Insert TOC after the main h1
      const h1 = document.querySelector('h1');
      if (h1 && h1.parentNode) {
        const wrapper = document.createElement('div');
        wrapper.className = 'toc-wrapper fade-in fade-in-target';
        const title = document.createElement('p');
        title.className = 'toc-title';
        title.textContent = 'ç›®æ¬¡ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§è©²å½“ç®‡æ‰€ã¸ç§»å‹•ï¼‰';
        wrapper.appendChild(title);
        wrapper.appendChild(ul);
        h1.insertAdjacentElement('afterend', wrapper);
      } else {
        toc.appendChild(ul);
      }
    })();

    // ============================
    // IntersectionObserver ã‚’ä½¿ã£ãŸãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
    // - .fade-in-target ã‚’ç›£è¦–ã—ã¦ .visible ã‚’ä»˜ä¸
    // ============================
    (function initScrollAnimations() {
      const targets = document.querySelectorAll('.fade-in-target');
      if (!targets.length) return;
      const io = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            // 1å›ã ã‘ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ãªã‚‰ unobserve ã™ã‚‹
            io.unobserve(entry.target);
          }
        });
      }, { threshold: 0.12 });
      targets.forEach(t => io.observe(t));
    })();

    // ============================
    // ã€Œãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹ã€ãƒœã‚¿ãƒ³ã®è¡¨ç¤º & ã‚¹ãƒ ãƒ¼ã‚¹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    // - ä¸€ç”»é¢åˆ†ï¼ˆwindow.innerHeightï¼‰ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ãŸã‚‰è¡¨ç¤º
    // - ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ã‚¹ãƒ ãƒ¼ã‚¹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    // ============================
    (function initToTopButton() {
      const btn = document.getElementById('to-top');
      if (!btn) return;
      function check() {
        if (window.scrollY > window.innerHeight) {
          btn.classList.add('show');
        } else {
          btn.classList.remove('show');
        }
      }
      window.addEventListener('scroll', check, { passive: true });
      window.addEventListener('resize', check);
      // åˆå›ãƒã‚§ãƒƒã‚¯
      check();

      btn.addEventListener('click', function () {
        window.scrollTo({ top: 0, behavior: 'smooth' });
        btn.blur();
      });
      // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã« Enter/Space ã‚’ãƒãƒ³ãƒ‰ãƒ«
      btn.addEventListener('keydown', function (e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          btn.click();
        }
      });
    })();

    // ============================
    // è£œåŠ©ï¼šhashãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ä½™ç™½åˆ†ã ã‘ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’è£œæ­£ï¼ˆå›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼å¯¾å¿œï¼‰
    // - ãƒšãƒ¼ã‚¸å†…ãƒªãƒ³ã‚¯ãŒãƒ˜ãƒƒãƒ€ãƒ¼ã«éš ã‚Œãªã„ã‚ˆã†ã€ã‚¯ãƒªãƒƒã‚¯æ™‚/ãƒ­ãƒ¼ãƒ‰æ™‚ã«èª¿æ•´
    // ============================
    (function adjustHashOffset() {
      function offsetScroll() {
        if (location.hash) {
          const el = document.getElementById(location.hash.slice(1));
          if (el) {
            const headerH = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--header-height')) || 72;
            const rect = el.getBoundingClientRect();
            const absoluteTop = window.scrollY + rect.top - headerH - 12; // å°‘ã—ä½™è£•
            window.scrollTo({ top: absoluteTop, behavior: 'smooth' });
          }
        }
      }
      // hash ãŒã‚ã‚‹å ´åˆãƒ­ãƒ¼ãƒ‰å¾Œã«è£œæ­£
      window.addEventListener('load', function(){ setTimeout(offsetScroll, 80); });
      // ãƒšãƒ¼ã‚¸å†…ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ã‚‚è£œæ­£
      document.addEventListener('click', function(e){
        const a = e.target.closest('a[href^="#"]');
        if (a) {
          // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¾Œã«è£œæ­£
          setTimeout(offsetScroll, 10);
        }
      });
    })();
  </script>
</body>
</html>
